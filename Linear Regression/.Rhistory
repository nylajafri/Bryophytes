### Set Working Directory
setwd("C:/Users/nylaj/Desktop/Code/Bryophytes/General Linear Model")
### Set Working Directory
setwd("C:/Users/nylaj/Desktop/Code/Bryophytes/Linear Regression")
### Dependencies
install.packages("sjPlot")
library(sjPlot)
library(lme4)
library(ggplot2)
library(car)
### Load Data
bryophyte <- read.csv("FBQ_Data_Sheet.csv")
View(bryophyte)
##Moss Area nad Mmicro Cat have high p value
### Compare Data
boxplot(bryophyte$moss_area_m2~bryophyte$water_pres, xlab='Urban Heat Island Index',
ylab='Site Name')
boxplot(bryophyte$num_species~bryophyte$heat_island, xlab='Urban Heat Island Index',
ylab='Site Name')
boxplot(bryophyte$num_col~bryophyte$heat_island, xlab='Urban Heat Island Index',
ylab='Site Name')
### Linear Regression Test
## Moss Area
modelarea <- lm(moss_area_m2 ~ uhii_year + can_cov + max_humidity + min_humidity, data = bryophyte)
summary(modelarea)
## Number of Colonies
modelcolony <- lm(num_col ~ uhii_year + can_cov + max_humidity + min_humidity, data = bryophyte)
summary(modelcolony)
## Number of Species
modelspecies <- lm(num_species ~ uhii_year + can_cov + max_humidity + min_humidity, data = bryophyte)
summary(modelspecies)
### Print Table
tab_model(modelarea, modelcolony, modelspecies,
pred.labels = c("Intercept", "Urban Heat Island Index (over 1 year)",
"Canopy Cover", "Maximum Humidity (over 1 year)",
"Minimum Humidity (over 1 year)"),
dv.labels = c("Moss Area (m^2)", "Number of Colonies", "Number of Species"))
### Plot Linear Regressions
avPlots(modelarea)
avPlots(modelcolony)
avPlots(modelspecies)
##Plot Significant Figures
plot(bryophyte$can_cov, bryophyte$num_col, xlab = "Canopy Cover (Percentage)", ylab = "Number of Colonies")
abline(lm(bryophyte$can_cov~bryophyte$num_col), col="red") # regression line (y~x)
plot(bryophyte$can_cov, bryophyte$num_species, xlab = "Canopy Cover (Percentage)", ylab = "Number of Species")
abline(lm(bryophyte$can_cov~bryophyte$num_species), col="red") # regression line (y~x)
AIC(modelarea, modelcolony, modelspecies)
AIC(modelarea)
AIC(modelcolony)
AIC(modelspecies)
### GLM for Each Applicable Dependent Variable
speciesglm <- glm(num_species ~ heat_island + micro_cat + water_pres + growth_cat
+ dist_walk_cat + dist_road_cat, family = poisson, data = bryophyte)
avPlots(speciesglm)
colonyglm <- glm(num_col ~ heat_island + micro_cat + water_pres + growth_cat
+ dist_walk_cat + dist_road_cat, family = poisson, data = bryophyte)
avPlots(colonyglm)
### Table
tab_model(colonyglm, speciesglm,
pred.labels = c("Intercept", "Urban Heat Island Index (over 1 year)", "Microhabitat",
"Water Present", "Growth Substrate", "Distance to Walkway", "Distance to Road"),
dv.labels = c("Number of Colonies", "Number of Species"))
abline(lm(bryophyte$heat_island ~ bryophyte$num_species), col="red")
plot(bryophyte$heat_island, bryophyte$num_col, xlab = "Heat Island Index (over 1 year)", ylab = "Number of Colonies")
#Significant Figures
plot(bryophyte$heat_island, bryophyte$num_species, xlab = "Heat Island Index (over 1 year)", ylab = "Number of Species")
abline(lm(bryophyte$heat_island ~ bryophyte$num_species), col="red")
plot(bryophyte$heat_island, bryophyte$num_col, xlab = "Heat Island Index (over 1 year)", ylab = "Number of Colonies")
abline(lm(bryophyte$heat_island ~ bryophyte$num_col), col="red")
plot(bryophyte$micro_cat, bryophyte$num_col, xlab = "Microhabitat Type", ylab = "Number of Colonies")
abline(lm(bryophyte$micro_cat ~ bryophyte$num_col), col="red")
plot(bryophyte$water_pres, bryophyte$num_species, xlab = "Water Present", ylab = "Number of Species")
abline(lm(bryophyte$water_pres ~ bryophyte$num_species), col="red")
plot(bryophyte$water_pres, bryophyte$num_col, xlab = "Water Present", ylab = "Number of Colonies")
abline(lm(bryophyte$water_pres ~ bryophyte$num_col), col="red")
plot(bryophyte$growth_cat, bryophyte$num_col, xlab = "Growth Substrate", ylab = "Number of Colonies")
abline(lm(bryophyte$growth_cat ~ bryophyte$num_col), col="red")
plot(bryophyte$dist_walk_cat, bryophyte$num_col, xlab = "Distance to Walkway", ylab = "Number of Colonies")
abline(lm(bryophyte$dist_walk_cat ~ bryophyte$num_col), col="red")
plot(bryophyte$dist_road_cat, bryophyte$num_col, xlab = "Distance to Road", ylab = "Number of Colonies")
abline(lm(bryophyte$dist_road_cat ~ bryophyte$num_col), col="red")
###Check Models (this got rid of Moss Area using GLM since its results are not integers)
AIC(mossareaglm)
abline(lm(bryophyte$heat_island ~ bryophyte$num_species), col="red")
### Significant Figures
plot(bryophyte$heat_island, bryophyte$num_species, xlab = "Heat Island Index (over 1 year)", ylab = "Number of Species")
abline(lm(bryophyte$heat_island ~ bryophyte$num_species), col="red")
### Significant Figures
plot(bryophyte$heat_island, bryophyte$num_species, xlab = "Heat Island Index (over 1 year)", ylab = "Number of Species")
abline(lm(bryophyte$heat_island ~ bryophyte$num_species), col="red")
